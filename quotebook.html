<html>
    <head>
        <meta http-equiv="Content-type" content="text/html; charset=utf-8">
        <script src="jquery-1.7.2.js"></script>
        <script type="text/javascript" src="jquery.parse.js"></script>
        <link rel="stylesheet/less" href="bootstrap/less/bootstrap.less">
        <script src="less-1.3.0.min.js"></script>
        <script src="bootstrap/js/bootstrap-modal.js"></script>
        <script type="text/javascript">
            console.log("QuoteBook app started");
        </script>

    </head>

    <body>
        <script type="text/javascript">
            $.parse.init({
                app_id : "eL5Zl4jRY6fUD3PcmbC6yObE3gSmdwfxShYmkOPi",
                rest_key : "rbNCJ1Mc10EbtICDHCIQmE6gxkeO4NCDXCLDLP0y"    
            });
            
            /*
            /   server methods 
            */
            function getQuotesFromServer(){
                ar req = $.parse.get('Quotes',{},processServerResult);
                console.log("get request :"+req);                
            }
            
            function processServerResult(req){
                console.log("halt");
                for (i in req.results)
                {
                    quoteList[i] = req.results[i];
                }
            };    
            
            function submitNewQuoteToServer(){
                $('.quotePart');
            }
            
            /*
            /   view methods 
            */
            function addNewQuotePart(){
                if($('.quote > tbody > tr').size() > 10){
                    alert("A quote with more that 10 parts to it is a short story!");
                }else{
                $('#newQuotePartModel').clone().removeClass('hidden').addClass('quotePart').appendTo('.quote > tbody');
                }
            }
            
            function removeNewQuotePart(){
                $('.quote > tbody > tr:last-child').remove();
            }
            
            function addQuoteToList(quoteToAdd){
                $('#quoteModel').clone().removeClass('hidden').appendTo('#quoteList > tbody');
            };
        </script>      
        
        <!-- QuoteList  view -->
        <table class="table table-striped" id="quoteList">
            <tbody>
                <!-- This <tr> element shall be coppied for each quote added to quotelist. Its the 'Model' for a quote -->
                <tr class="hidden" id="quoteModel">
                    <td>
                        <blockquote>
                            <p>First bit of a quote</p>
                            <p>Second bit of a quote</p>
                            <small>Chris Matheson, somewhere</small>
                        </blockquote>
                    </td>
                </tr>
                <tr>
                    <td>
                        <blockquote>
                            <p>First bit of a quote</p>
                            <p>Second bit of a quote</p>
                            <small>Chris Matheson, somewhere</small>
                        </blockquote>
                    </td>
                </tr>
                <tr>
                    <td>
                        <blockquote>
                            <p>First bit of a quote</p>
                            <p>Second bit of a quote</p>
                            <small>Chris Matheson, somewhere</small>
                        </blockquote>
                    </td>
                </tr>
            </tbody>
        </table>
        <button class="btn" onClick="addQuoteToList()">add</button>
        
        <!-- hidden modal view -->
        <div class="modal hidden fade in" id="addQuote">
          <div class="modal-header">
            <button class="close" data-dismiss="modal">Ã—</button>
            <h3>New Quote</h3>
          </div>
          <div class="modal-body">
            <input id="quoteLocation" class="span6" name="location" type="text" placeholder="Where were you when this happened?">
            <table class="quote table-striped">
                <tbody>
                    <!-- This <tr> element shall be coppied when the plus button is hit. Its the 'Model' for a quote part -->
                    <tr class="hidden" id="newQuotePartModel">
                        <td class="quotePart"><input class="span2" type="text" placeholder="Who">  </input><input class="span4" type="text" placeholder="Said What?"></input></td>
                    </tr>
                    <tr>
                        <td class="quotePart" style="{height: 22px}"><input class="span2" type="text" placeholder="Who">  </input><input class="span4" type="text" placeholder="Said What?"></input></td>
                    </tr>
                </tbody>
            </table>
            <input id="quoteMeta" class="span6" name="location" type="text" placeholder="anything else that needs added.">
          </div>
          <div class="modal-footer">
            <button href="#" class="btn" onClick="addNewQuotePart()">+</button>
            <button href="#" class="btn" onClick="removeNewQuotePart()">-</button>
            <button href="#" class="btn btn-primary" onClick="submitNewQuoteToServer()">Submit</button>
          </div>
        </div>
        <!-- End of modal view -->
        <button class="btn" onClick="$('#addQuote').modal()">Add Your Quote</button>
        
    </body>
</html>