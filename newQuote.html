<!DOCTYPE html>
<html>
    <head>
        <title> </title>
        <!--imports-->
        <script src="jquery-1.7.2.js"></script>
        <script type="text/javascript" src="jquery.parse.js"></script>
        <link rel="stylesheet/less" href="bootstrap/less/bootstrap.less">
        <script src="less-1.3.0.min.js"></script>
        
        <script type="text/javascript">
            console.log("app started");
                                    
            $(document).ready(function(){
                               
                $.parse.init({
                    app_id : "eL5Zl4jRY6fUD3PcmbC6yObE3gSmdwfxShYmkOPi",
                    rest_key : "rbNCJ1Mc10EbtICDHCIQmE6gxkeO4NCDXCLDLP0y"    
                });
                               
            });
            // define part object to go into Parse
            function quote(){
                this.location;
                this.parts = [];
                this.extra = "";
            }
            
            function quotePart(){
                    this.name = "";
                    this.said = "";
                };
            
            function addPart(){
               //$(".quote").append('<li class="quotePart" style="list-style-type: none"><input type="text" Value="Who"></input><input type="text" Value="Said What?"></input></li>');
               var newQP = document.createElement('tr');
               $(newQP).addClass("quotePart");
               $(newQP).css({'list-style-type': 'none'})
                $(".quote").append(newQP);
               
               for (val in ["Who","Said What?"]){
                   var newInput = document.createElement('input');
                   newInput.class = "span2";
                   newInput.type = "text";
                   newInput.placeholder = val;
                   $(".quote tbody").append(newInput);
               }

            }
            
            function addQuote(){
                console.log("adding quote to Parse DB");    
                var thisQuote = new quote();
                if (navigator.geolocation)
                {
                    navigator.geolocation.getCurrentPosition(function(pos){thisQuote.location = pos},function(fail){console.log(fail)});
                }else{
                       
                }
                
                $(".quote").find(".quotePart").each(function(){
                    //for each quotePart
                    var thisPart = new quotePart();
                    thisPart.name = $(this).find("input:nth(0)").val();
                    thisPart.said = $(this).find("input:nth(1)").val();
                    thisQuote.parts.push(thisPart);     
                });
                
                $.parse.post('Quotes',thisQuote, function(json){console.log(json)},function(json){console.log(json)});
            }
        </script>
    </head>
    <body>     
        <input id="quoteLocation" name="location" type="text" placeholder="Where were you when this happened?">
        <table class="quote table-striped">
            <tbody>
                <tr>
                    <td class="quotePart"><span class="add-on"><i class="icon-user"></i></span><input class="span2" type="text" placeholder="Who">  </input><input class="span4" type="text" placeholder="Said What?"></input></td>
                </tr>
                <tr>
                    <td class="quotePart"><span class="add-on"><i class="icon-user"></i></span><input class="span2" type="text" placeholder="Who">  </input><input class="span4" type="text" placeholder="Said What?"></input></td>
                </tr>
            </tbody>
        </table>

        <button class="btn" onClick="addPart()">+</button>
        <button class="btn">-</button>
        <button class="btn btn-primary" onClick="addQuote()">Submit</button>
        
        
    </body>
</html>